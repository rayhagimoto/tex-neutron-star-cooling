%====
% Appendix A: Derivation of the recursive relation in eq:recursive-phase-space-relation
%====
\section{Derivation of recursive relation}
This appendix fills in the details for the derivation of eq. (\ref{eq:recursive-phase-space-relation}) which are left out in~\cite{Byckling:1969sx}. Our starting point is 
\begin{align*}
    R_n(s) 
        &= 
        \int \prod_{i=1}^{n} \delta (p_i^2 - m_i^2) \, \Theta(p_i^0) \, 
        \dd^4 p_i \, \delta^4(p_a + p_b - p_1 - \cdots - p_n) \\
        &=
        \int
        \delta(p_n^2 - m_n^2) \, \Theta(p_n^0) \, \dd^4 p_n 
        \bigg[
            \prod_{i=1}^{n-1} 
            \delta (p_i^2 - m_i^2) \, \Theta(p_i^0)
        \bigg]
        \delta^4(p_a +  p_b - p_n - p_1 - \cdots - p_{n-1}) \\
        &=
        \int
        \delta(p_n^2 - m_n^2) \, \Theta(p_n^0) \, \dd^4 p_n \, 
        R_{n-1}(p_a + p_b - p_n)
\end{align*}
Multiply the RHS by $\int \dd M_{n-1}^2\,\delta(M_{n-1}^2 - (p_a + p_b - p_n)^2)$. 
\begin{align*}
    \int \dd M_{n-1}^2 \, \delta\big(M_{n-1}^2 - (p_a + p_b - p_n)^2\big) \,
    \delta(p_n^2 - m_n^2) \, \Theta(p_n^0) \, \dd^4 p_n \,
    R_{n-1}\big(p_a + p_b - p_n\big).
\end{align*}
Use the on-shell delta function to do the $p_n^0$ integral and write $\dd^3 p_n$ in terms of spherical coordinates:
\begin{align*}
    &\int \dd M_{n-1}^2 \, \delta\big(M_{n-1}^2 - (p_a + p_b - p_n)^2\big) \,
    \, \frac{\dd^3 p_n}{2 E_n} \,
    R_{n-1}\big(p_a + p_b - p_n\big)\\
    &= 
    \int \dd M_{n-1}^2 \, \delta\big(M_{n-1}^2 - (p_a + p_b - p_n)^2\big) \,
    \, \frac{|\bm{p}_n|^2 \dd |\bm{p}_n| \dd \Omega_n}{2 E_n} \,
    R_{n-1}\big(p_a + p_b - p_n\big).
\end{align*}
Then use the $M_{n-1}^2$ Dirac delta to do the $\dd |\bm{p}_n|$ integral. 
This requires us to (i) solve $M_{n-1}^2 - (p_a + p_b - p_n)^2 = 0$ for $|\bm{p}_n|$; (ii) evaluate $\dd / \dd |\bm{p}_n| \big(M_{n-1}^2 - (p_a + p_b - p_n)^2\big)$; and (iii) impose $|\bm{p}_n|^2 \geq 0$ to derive bounds of integration for $\int \dd M_{n-1}^2$.
%===
% enumerate environment
%===
\begin{enumerate}[label=(\roman*)]
    %----
    % (i) Solving for |p_n|
    %----
    \item We start by expanding the LHS
    \begin{align*}
        &M_{n-1}^2 - (p_a + p_b - p_n)^2 = M_{n-1}^2 - (p_a + p_b)^2 - p_n^2 + 2(p_a + p_b) \cdot p_n \\
        &= M_{n-1}^2 - s - m_n^2 + 2 (E_a + E_b) E_n + 2 (\bm{p}_a + \bm{p}_b) \cdot \bm{p}_n.
    \end{align*}
    Now we choose the center of mass frame so that $\bm{p}_a + \bm{p}_b = 0$. This is valid because the integral is a Lorentz invariant, so the final result is independent of the reference frame. 
    \begin{align*}
        &M_{n-1}^2 - s - m_n^2 + 2 (E_a + E_b) E_n + 2 (\bm{p}_a + \bm{p}_b) \cdot \bm{p}_n\\
        &=
        M_{n-1}^2 - s - m_n^2 + 2 \, \sqrt{s} \, \sqrt{|\bm{p}_n|^2 + m_n^2} = 0.
    \end{align*}
    Now we can rearrange and solve for $|\bm{p}_n|$
    \begin{align*}
        |\bm{p}_n|^2 
        &=
        \frac{(s + m_n^2 - M_{n-1}^2)^2}{4 s} - m_n^2 = 
        \frac{s^2 + m_n^4 + M_{n-1}^4 - 2 s m_n^2 - 2 s M_{n-1}^2 - 2 m_n^2 M_{n-1}^2}{4 s} \\
        &\equiv \boxed{\frac{\lambda(s, M_{n-1}^2, m_n^2)}{4s}}\;.
    \end{align*}
    $\lambda(x,y,z) = x^2 + y^2 + z^2 - 2xy - 2xz - 2yz$ is called the \href{https://en.wikipedia.org/wiki/K%C3%A4ll%C3%A9n_function}{K\"{a}llen function}.
    %----
    % (ii) Evaluating a derivative
    %----
    \item%
    \begin{align*}
        &\frac{\dd}{\dd |\bm{p}_n|} 
        \bigg( 
            M_{n-1}^2 - (p_a + p_b - p_n)^2
        \bigg)\\
        &= 
        \frac{\dd}{\dd |\bm{p}_n|} 
        \bigg( 
            M_{n-1}^2 - s - m_n^2 + 2 \, \sqrt{s} \, \sqrt{|\bm{p}_n|^2 + m_n^2}
        \bigg)\\
        &=
        \boxed{\frac{2\sqrt{s}\,|\bm{p}_n|}{E_n}}
    \end{align*}
    %----
    % (iii) Getting upper bound of integration by imposing |p_n| > 0
    %----
    \item%
    \begin{align*}
        &|\bm{p}_n|^2 \geq 0 \\
        &\Rightarrow \lambda(s, M_{n-1}^2, m_n^2) \geq 0\\
        &\Rightarrow 
        \big[
            M_{n-1}^2 - (s + m_n^2)
        \big]^2
        - 4\,s m_n^2
        \geq 0\\
        &\Rightarrow
        \big[
            M_{n-1}^2 - (s + m_n^2)
        \big]^2
        \geq 4\,s m_n^2\\
        &\Rightarrow
            M_{n-1}^2 - (s + m_n^2) \geq 2 \sqrt{s\, m_n^2} 
            \; \big|\big| \;
            M_{n-1}^2 - (s + m_n^2) \leq - 2 \sqrt{s\, m_n^2}  \\
            &\Rightarrow
            M_{n-1}^2 \geq (s + m_n^2) + 2 \sqrt{s\, m_n^2} 
            \; \big|\big| \;
            M_{n-1}^2 \leq (s + m_n^2) - 2 \sqrt{s\, m_n^2}  \\
            &\Rightarrow
            \boxed{
                M_{n-1}^2 \geq (\sqrt{s} + m_n)^2
                \; \big|\big| \;
                M_{n-1}^2 \leq (\sqrt{s} - m_n)^2.
            }
    \end{align*}
    
\end{enumerate}
With these results established we find that 
\begin{align}
    \delta \big( M_{n-1}^2 - (p_a + p_b - p_n)^2 \big)
    = \frac{
        \delta \Big(
        |\bm{p}_n| - \sqrt{\lambda(s, M_{n-1}^2, m_n^2)} \Big/ (2 \sqrt{s})    
    \Big)
    }
    {
        2 \sqrt{s}\, |\bm{p}_n| / E_n
    }\;\;.
\end{align}
Hence,
\begin{align*}
    &\int \dd M_{n-1}^2 \, \delta\big(M_{n-1}^2 - (p_a + p_b - p_n)^2\big) \,
    \, \frac{|\bm{p}_n|^2 \dd |\bm{p}_n| \dd \Omega_n}{2 E_n} \,
    R_{n-1}\big(p_a + p_b - p_n\big)\\
    &= 
    \int \dd M_{n-1}^2 \, 
    \frac{
        \delta \Big(
        |\bm{p}_n| - \sqrt{\lambda(s, M_{n-1}^2, m_n^2)} \Big/ (2 \sqrt{s})    
    \Big)
    }
    {
        2 \sqrt{s}\, |\bm{p}_n| / E_n
    }
    \,
    \, \frac{|\bm{p}_n|^2 \dd |\bm{p}_n| \dd \Omega_n}{2 E_n} \,
    R_{n-1}\big(p_a + p_b - p_n\big) \\
    &=
    \int \dd M_{n-1}^2 \, 
    \frac{\sqrt{\lambda(s, M_{n-1}^2, m_n^2)}}{8 s}
    \, \dd \Omega_n \,
    R_{n-1}\big(M_{n-1}^2).
\end{align*}
